Problem 1: Logistic Regression for Customer Purchase Prediction



import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, confusion_matrix

# Generate synthetic dataset
np.random.seed(42)
n_samples = 500

# Create features
age = np.random.randint(18, 65, n_samples)
income = np.random.randint(20000, 150000, n_samples)
browsing_time = np.random.rand(n_samples) * 120  # minutes

# Create target (purchase decision) based on patterns
# Higher age, income, and browsing time increase purchase probability
purchase_prob = (age/65)*0.3 + (income/150000)*0.4 + (browsing_time/120)*0.3 + np.random.randn(n_samples)*0.1
purchased = (purchase_prob > 0.5).astype(int)

# Create DataFrame
df = pd.DataFrame({
    'Age': age,
    'Income': income,
    'Browsing_Time': browsing_time,
    'Purchased': purchased
})

# Split features and target
X = df[['Age', 'Income', 'Browsing_Time']]
y = df['Purchased']

# Scale features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Split train-test
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)

# Train Logistic Regression
model = LogisticRegression()
model.fit(X_train, y_train)

# Predict
y_pred = model.predict(X_test)

# Evaluate
print("=== Model Performance ===")
print(f"Accuracy:  {accuracy_score(y_test, y_pred):.2%}")
print(f"Precision: {precision_score(y_test, y_pred):.2%}")
print(f"Recall:    {recall_score(y_test, y_pred):.2%}")
print(f"F1-Score:  {f1_score(y_test, y_pred):.2%}")

# Confusion Matrix
cm = confusion_matrix(y_test, y_pred)
plt.figure(figsize=(6, 4))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', 
            xticklabels=['No Purchase', 'Purchase'],
            yticklabels=['No Purchase', 'Purchase'])
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.title('Confusion Matrix')
plt.show()

# Feature importance
feature_importance = pd.DataFrame({
    'Feature': ['Age', 'Income', 'Browsing_Time'],
    'Coefficient': model.coef_[0]
}).sort_values('Coefficient', key=abs, ascending=False)
print("\n=== Feature Importance ===")
print(feature_importance)


Problem 2: Linear Regression for House Price Prediction


import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import StandardScaler

# Generate synthetic house dataset
np.random.seed(42)
n_samples = 300

# Create features
size = np.random.randint(800, 4000, n_samples)  # sq ft
bedrooms = np.random.randint(1, 6, n_samples)
bathrooms = np.random.randint(1, 4, n_samples)
age = np.random.randint(0, 50, n_samples)  # years

# Create target price based on features
# Base price: $200 per sq ft + extras for rooms + depreciation
price = (size * 200 + 
         bedrooms * 30000 + 
         bathrooms * 20000 - 
         age * 1000 + 
         np.random.randn(n_samples) * 50000)

# Ensure no negative prices
price = np.maximum(price, 50000)

# Create DataFrame
df = pd.DataFrame({
    'Size': size,
    'Bedrooms': bedrooms,
    'Bathrooms': bathrooms,
    'Age': age,
    'Price': price
})

# Split features and target
X = df[['Size', 'Bedrooms', 'Bathrooms', 'Age']]
y = df['Price']

# Scale features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Split train-test
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)

# Train Linear Regression
model = LinearRegression()
model.fit(X_train, y_train)

# Predict
y_pred = model.predict(X_test)

# Evaluate
print("=== Model Performance ===")
print(f"RÂ² Score: {r2_score(y_test, y_pred):.4f}")
print(f"MSE: {mean_squared_error(y_test, y_pred):,.2f}")
print(f"RMSE: {np.sqrt(mean_squared_error(y_test, y_pred)):,.2f}")

# Coefficients
coefficients = pd.DataFrame({
    'Feature': ['Size', 'Bedrooms', 'Bathrooms', 'Age'],
    'Coefficient': model.coef_
}).sort_values('Coefficient', key=abs, ascending=False)
print("\n=== Feature Coefficients ===")
print(coefficients)
print(f"\nIntercept: ${model.intercept_:,.2f}")

# Visualize predictions vs actual
plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2)
plt.xlabel('Actual Prices')
plt.ylabel('Predicted Prices')
plt.title('Actual vs Predicted House Prices')
plt.grid(True, alpha=0.3)
plt.show()

# Residual plot
residuals = y_test - y_pred
plt.figure(figsize=(8, 4))
plt.scatter(y_pred, residuals, alpha=0.7)
plt.axhline(y=0, color='r', linestyle='--')
plt.xlabel('Predicted Prices')
plt.ylabel('Residuals')
plt.title('Residual Plot')
plt.grid(True, alpha=0.3)
plt.show()

